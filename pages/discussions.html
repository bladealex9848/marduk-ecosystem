<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discusiones - Marduk</title>
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.5/dist/sweetalert2.min.css">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/fixes.css">
    <link rel="stylesheet" href="../css/search.css">

    <!-- Tema oscuro/claro -->
    <script>
      // Verificar preferencia guardada
      const darkModeEnabled = localStorage.getItem('darkModeEnabled') === 'true';
      // Verificar preferencia del sistema
      const prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;

      // Aplicar tema oscuro si está habilitado o preferido por el sistema
      if (darkModeEnabled || (prefersDarkMode && darkModeEnabled !== 'false')) {
        document.documentElement.setAttribute('data-theme', 'dark');
        document.body.classList.add('dark-mode');
        localStorage.setItem('darkModeEnabled', 'true');
      }
    </script>
</head>
<body>
    <!-- Header/Navbar -->
    <header class="navbar navbar-expand-lg navbar-dark bg-gradient sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="../index.html">
                <i class="fas fa-balance-scale me-2"></i>
                <span>Marduk</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html"><i class="fas fa-home me-1"></i> Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="solutions.html"><i class="fas fa-tools me-1"></i> Soluciones</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="community.html"><i class="fas fa-users me-1"></i> Comunidad</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="discussions.html"><i class="fas fa-comments me-1"></i> Discusiones</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="ai-test.html"><i class="fas fa-robot me-1"></i> Prueba IA</a>
                    </li>
                </ul>
                <div class="d-flex align-items-center">
                    <!-- Search Form -->
                    <form class="d-flex me-2 search-container">
                        <div class="position-relative w-100">
                            <i class="fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"></i>
                            <input class="form-control ps-5" type="search" placeholder="Buscar..." aria-label="Search">
                        </div>
                    </form>
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="btn btn-link text-light me-3">
                        <i class="fas fa-moon"></i>
                    </button>
                    <!-- Notifications Dropdown -->
                    <div class="dropdown me-2">
                        <button class="btn btn-link text-light position-relative p-1" type="button" id="notificationsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-bell"></i>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                3
                            </span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end notification-dropdown p-0 overflow-hidden" aria-labelledby="notificationsDropdown">
                            <!-- Notification header -->
                            <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                                <h6 class="mb-0">Notificaciones</h6>
                                <a href="#" class="text-decoration-none small">Marcar todas como leídas</a>
                            </div>
                            <!-- Notification items -->
                            <div class="notification-list">
                                <a href="#" class="notification-item d-flex p-3 border-bottom unread">
                                    <div class="flex-shrink-0">
                                        <div class="avatar-circle bg-primary text-white">
                                            <i class="fas fa-gavel"></i>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <p class="mb-0 fw-medium">Nueva actualización en el caso #12345</p>
                                        <p class="text-muted small mb-0">Se ha añadido un nuevo documento</p>
                                        <span class="text-muted small">Hace 5 minutos</span>
                                    </div>
                                </a>
                                <!-- More notification items... -->
                            </div>
                            <!-- View all link -->
                            <a href="#" class="dropdown-item text-center p-3 border-top">Ver todas las notificaciones</a>
                        </div>
                    </div>
                    <!-- User Menu -->
                    <div class="dropdown">
                        <button class="btn btn-link d-flex align-items-center text-light text-decoration-none dropdown-toggle" type="button" id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="avatar-circle avatar-circle-sm bg-primary text-white me-2">
                                AF
                            </div>
                            <span class="d-none d-md-block">Alexander Fadul</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu">
                            <li><a class="dropdown-item" href="profile.html"><i class="fas fa-user me-2"></i> Mi Perfil</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i> Configuración</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i> Cerrar Sesión</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container py-4">
        <!-- Banner de Discusiones -->
        <div class="card border-0 bg-gradient-indigo mb-4 rounded-3 theme-immune">
            <div class="card-body text-white p-4">
                <h1 class="h3 fw-bold">Foros de Discusión</h1>
                <p class="mb-4 opacity-90">
                    Participa en conversaciones sobre el ecosistema Marduk, comparte experiencias y aprende de otros profesionales judiciales.
                </p>

                <!-- Acciones rápidas -->
                <div class="d-flex flex-wrap gap-2">
                    <button class="btn btn-light">
                        <i class="fas fa-plus-circle me-2"></i>Iniciar nueva discusión
                    </button>
                    <button class="btn btn-outline-light">
                        <i class="fas fa-star me-2"></i>Discusiones destacadas
                    </button>
                    <button class="btn btn-outline-light">
                        <i class="fas fa-bookmark me-2"></i>Mis discusiones guardadas
                    </button>
                </div>
            </div>
        </div>

        <!-- Filtros y Búsqueda -->
        <div class="row mb-4">
            <!-- Filtros de Categorías -->
            <div class="col-md-8 mb-3 mb-md-0">
                <div class="d-flex flex-wrap gap-2" id="categoryFilters">
                    <button class="btn btn-primary" data-category="all">
                        <i class="fas fa-layer-group me-2"></i>Todas
                    </button>
                    <button class="btn btn-outline-secondary" data-category="general">
                        <i class="fas fa-comments me-2"></i>General
                    </button>
                    <button class="btn btn-outline-secondary" data-category="soluciones">
                        <i class="fas fa-tools me-2"></i>Soluciones
                    </button>
                    <button class="btn btn-outline-secondary" data-category="practicas">
                        <i class="fas fa-lightbulb me-2"></i>Mejores Prácticas
                    </button>
                    <button class="btn btn-outline-secondary" data-category="colaboracion">
                        <i class="fas fa-users me-2"></i>Colaboración
                    </button>
                    <button class="btn btn-outline-secondary" data-category="tecnico">
                        <i class="fas fa-code me-2"></i>Técnico
                    </button>
                </div>
            </div>

            <!-- Barra de Búsqueda -->
            <div class="col-md-4">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Buscar discusiones..." id="searchInput">
                    <button class="btn btn-primary" type="button">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Filtros adicionales -->
        <div class="card mb-4 border">
            <div class="card-body p-3">
                <div class="row align-items-center">
                    <div class="col-md-3 mb-3 mb-md-0">
                        <label class="form-label small mb-1">Ordenar por</label>
                        <select class="form-select form-select-sm" id="sortFilter">
                            <option value="recent">Más recientes</option>
                            <option value="popular">Más populares</option>
                            <option value="activity">Mayor actividad</option>
                            <option value="unanswered">Sin respuestas</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3 mb-md-0">
                        <label class="form-label small mb-1">Estado</label>
                        <select class="form-select form-select-sm" id="statusFilter">
                            <option value="all">Todos</option>
                            <option value="open">Abiertos</option>
                            <option value="solved">Resueltos</option>
                            <option value="closed">Cerrados</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3 mb-md-0">
                        <label class="form-label small mb-1">Etiquetas</label>
                        <select class="form-select form-select-sm" id="tagFilter">
                            <option value="all">Todas</option>
                            <option value="implementacion">Implementación</option>
                            <option value="desarrollo">Desarrollo</option>
                            <option value="integracion">Integración</option>
                            <option value="api">API</option>
                        </select>
                    </div>
                    <div class="col-md-3 d-flex align-items-end justify-content-end">
                        <button class="btn btn-sm btn-outline-secondary me-2">
                            <i class="fas fa-redo-alt me-1"></i>Reiniciar
                        </button>
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-filter me-1"></i>Aplicar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contenedor Principal -->
        <div id="mainContent">
            <!-- Contenedor de Discusiones -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-0">
                    <div class="list-group list-group-flush" id="discussionsList">
                        <!-- Las discusiones se cargarán dinámicamente aquí -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Detallada de Discusión (inicialmente oculta) -->
        <div id="discussionDetail" class="d-none">
            <!-- Cabecera de la discusión -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <!-- Botón para volver -->
                    <button id="backToList" class="btn btn-sm btn-outline-secondary mb-3">
                        <i class="fas fa-arrow-left me-2"></i>Volver a la lista
                    </button>

                    <!-- Título y detalles -->
                    <div class="d-flex align-items-start">
                        <div class="avatar-circle me-3" id="detailAuthorAvatar">MR</div>
                        <div class="flex-grow-1">
                            <div class="d-flex justify-content-between align-items-center flex-wrap">
                                <h1 class="h4 fw-bold mb-1" id="detailTitle">Título de la discusión</h1>
                                <span class="badge bg-success" id="detailStatus">Activo</span>
                            </div>
                            <div class="d-flex flex-wrap gap-1 mb-3" id="detailTags">
                                <!-- Las etiquetas se cargarán dinámicamente -->
                            </div>
                            <div class="d-flex justify-content-between align-items-center flex-wrap">
                                <div class="d-flex align-items-center small text-muted">
                                    <span>Por <strong id="detailAuthorName">María Rodríguez</strong></span>
                                    <span class="mx-2">•</span>
                                    <span id="detailAuthorRole">Juez Civil Municipal</span>
                                </div>
                                <div class="d-flex align-items-center small text-muted">
                                    <span><i class="fa-solid fa-eye me-1"></i> <span id="detailViews">128</span> vistas</span>
                                    <span class="mx-2">•</span>
                                    <span id="detailLastUpdate">Actualizado hace 4 horas</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contenido de la discusión -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <div class="d-flex">
                        <div class="avatar-circle me-3" id="detailContentAvatar">MR</div>
                        <div class="flex-grow-1">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="fw-medium" id="detailContentAuthor">María Rodríguez</span>
                                    <span class="text-muted small ms-2" id="detailContentRole">Juez Civil Municipal</span>
                                </div>
                                <span class="text-muted small" id="detailContentDate">Publicado hace 2 días</span>
                            </div>
                            <div class="mt-3 mb-3 discussion-content" id="detailContent">
                                <!-- El contenido se cargará dinámicamente -->
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center gap-3">
                                    <button class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-thumbs-up me-1"></i> Me gusta
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-share me-1"></i> Compartir
                                    </button>
                                </div>
                                <button class="btn btn-sm btn-primary">
                                    <i class="fas fa-reply me-1"></i> Responder
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Respuestas -->
            <h3 class="h5 fw-bold mb-3">Respuestas (<span id="detailRepliesCount">35</span>)</h3>

            <div id="repliesList">
                <!-- Las respuestas se cargarán dinámicamente -->
                <div class="card border-0 shadow-sm mb-3">
                    <div class="card-body p-4">
                        <div class="d-flex">
                            <div class="avatar-circle-sm me-3">JP</div>
                            <div class="flex-grow-1">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <span class="fw-medium">Juan Pérez</span>
                                        <span class="text-muted small ms-2">Analista Judicial</span>
                                    </div>
                                    <span class="text-muted small">Hace 1 día</span>
                                </div>
                                <div class="mt-3 mb-3">
                                    <p>Excelente iniciativa. En nuestro juzgado implementamos OmniChat hace 3 meses y hemos notado una mejora significativa en la eficiencia.</p>
                                    <p>Algunos consejos que puedo compartir:</p>
                                    <ul>
                                        <li>Realizar capacitaciones por grupos pequeños</li>
                                        <li>Designar "campeones" que ayuden a sus compañeros</li>
                                        <li>Comenzar con casos de uso simples e ir avanzando</li>
                                    </ul>
                                </div>
                                <div class="d-flex align-items-center gap-3">
                                    <button class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-thumbs-up me-1"></i> Me gusta
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-reply me-1"></i> Responder
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card border-0 shadow-sm mb-3">
                    <div class="card-body p-4">
                        <div class="d-flex">
                            <div class="avatar-circle-sm me-3">CL</div>
                            <div class="flex-grow-1">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <span class="fw-medium">Carlos López</span>
                                        <span class="text-muted small ms-2">Desarrollador Senior</span>
                                    </div>
                                    <span class="text-muted small">Hace 2 días</span>
                                </div>
                                <div class="mt-3 mb-3">
                                    <p>¿Han considerado utilizar la versión lite de OmniChat? Está diseñada específicamente para entornos con recursos limitados y funciona muy bien.</p>
                                </div>
                                <div class="d-flex align-items-center gap-3">
                                    <button class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-thumbs-up me-1"></i> Me gusta
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-reply me-1"></i> Responder
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Formulario de respuesta -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h4 class="h6 fw-bold mb-3">Añadir respuesta</h4>
                    <div class="mb-3">
                        <textarea class="form-control" rows="4" placeholder="Escribe tu respuesta aquí..."></textarea>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-primary">
                            <i class="fas fa-paper-plane me-2"></i>Enviar respuesta
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Paginación -->
        <nav aria-label="Navegación de páginas">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Anterior</a>
                </li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                    <a class="page-link" href="#">Siguiente</a>
                </li>
            </ul>
        </nav>
    </main>

    <!-- Footer -->
    <footer class="bg-light py-4 mt-5 border-top">
        <div class="container">
            <div class="row justify-content-between align-items-center">
                <div class="col-md-4 mb-3 mb-md-0">
                    <h5 class="h6 fw-bold text-primary">Marduk</h5>
                    <p class="small text-secondary mb-0">Ecosistema de soluciones para la transformación judicial</p>
                </div>
                <div class="col-md-4 mb-3 mb-md-0 text-center">
                    <div class="d-flex flex-wrap justify-content-center gap-3 footer-links">
                        <a href="about.html" class="text-decoration-none text-secondary small">Acerca de</a>
                        <a href="policies.html" class="text-decoration-none text-secondary small">Políticas</a>
                        <a href="contribute.html" class="text-decoration-none text-secondary small">Contribuir</a>
                        <a href="support.html" class="text-decoration-none text-secondary small">Soporte</a>
                    </div>
                </div>
                <div class="col-md-4 text-md-end">
                    <p class="small text-muted mb-0">© 2025 Rama Judicial de Colombia</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5.3 Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.5/dist/sweetalert2.all.min.js"></script>

    <!-- Inicializar el toggle de tema -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Inicializar el toggle de tema
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
          // Actualizar el icono según el tema actual
          if (document.body.classList.contains('dark-mode')) {
            themeToggle.querySelector('i').classList.remove('fa-moon');
            themeToggle.querySelector('i').classList.add('fa-sun');
          }

          // Agregar evento de click
          themeToggle.addEventListener('click', function() {
            const isDarkMode = document.body.classList.contains('dark-mode');
            if (isDarkMode) {
              document.documentElement.removeAttribute('data-theme');
              document.body.classList.remove('dark-mode');
              localStorage.setItem('darkModeEnabled', 'false');
            } else {
              document.documentElement.setAttribute('data-theme', 'dark');
              document.body.classList.add('dark-mode');
              localStorage.setItem('darkModeEnabled', 'true');
            }

            // Actualizar el icono
            const themeIcon = themeToggle.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
              themeIcon.classList.remove('fa-moon');
              themeIcon.classList.add('fa-sun');
            } else {
              themeIcon.classList.remove('fa-sun');
              themeIcon.classList.add('fa-moon');
            }
          });
        }
      });
    </script>

    <!-- Script para manejar las discusiones -->
    <script>
        // Datos de ejemplo para las discusiones
        const discussions = [
            // Categoría: General
            {
                id: 1,
                title: "Anuncios oficiales",
                content: "Comunicados y novedades oficiales del ecosistema Marduk.",
                author: {
                    name: "Admin Marduk",
                    avatar: "AM",
                    role: "Administrador"
                },
                category: "general",
                tags: ["anuncios", "oficial", "novedades"],
                status: "open",
                replies: 312,
                views: 1450,
                lastUpdate: "Hace 1 hora",
                isHighlighted: true,
                topics: 45
            },
            {
                id: 2,
                title: "Bienvenida a nuevos miembros",
                content: "Presentaciones y orientación para nuevos usuarios del ecosistema Marduk.",
                author: {
                    name: "Laura Martínez",
                    avatar: "LM",
                    role: "Moderadora"
                },
                category: "general",
                tags: ["bienvenida", "nuevos usuarios", "orientación"],
                status: "open",
                replies: 754,
                views: 2103,
                lastUpdate: "Hace 3 horas",
                topics: 128
            },
            {
                id: 3,
                title: "Feedback y sugerencias",
                content: "Comparte tu opinión y sugiere mejoras para el ecosistema Marduk.",
                author: {
                    name: "Carlos Rodríguez",
                    avatar: "CR",
                    role: "Coordinador de Desarrollo"
                },
                category: "general",
                tags: ["feedback", "sugerencias", "mejoras"],
                status: "open",
                replies: 810,
                views: 1890,
                lastUpdate: "Hace 5 horas",
                topics: 75
            },

            // Categoría: Soluciones
            {
                id: 1,
                title: "Sistema de Gestión de Expedientes Judiciales",
                content: "Todo sobre SGEJ: implementación, uso y mejores prácticas.",
                author: {
                    name: "María Rodríguez",
                    avatar: "MR",
                    role: "Especialista SGEJ"
                },
                category: "soluciones",
                tags: ["SGEJ", "expedientes", "gestión"],
                status: "open",
                replies: 1452,
                views: 3580,
                lastUpdate: "Hace 2 horas",
                topics: 187
            },
            {
                id: 2,
                title: "OmniChat: Asistente Virtual Judicial",
                content: "Discusiones sobre OmniChat: configuración, casos de uso y actualizaciones.",
                author: {
                    name: "Juan Pérez",
                    avatar: "JP",
                    role: "Especialista en IA"
                },
                category: "soluciones",
                tags: ["OmniChat", "IA", "asistente virtual"],
                status: "open",
                replies: 982,
                views: 2450,
                lastUpdate: "Hace 4 horas",
                topics: 124
            },
            {
                id: 3,
                title: "MALLO (MultiAgent LLM Orchestrator)",
                content: "Discusiones sobre MALLO: implementación, casos de uso y desarrollo.",
                author: {
                    name: "Carlos López",
                    avatar: "CL",
                    role: "Ingeniero de IA"
                },
                category: "soluciones",
                tags: ["MALLO", "agentes", "orquestación"],
                status: "open",
                replies: 745,
                views: 1890,
                lastUpdate: "Hace 6 horas",
                topics: 98
            },
            {
                id: 4,
                title: "Estrategias para implementar IA en tribunales pequeños",
                content: "Compartiendo experiencias sobre la implementación de OmniChat en juzgados con recursos limitados.",
                author: {
                    name: "María Rodríguez",
                    avatar: "MR",
                    role: "Juez Civil Municipal"
                },
                category: "soluciones",
                tags: ["IA", "implementación", "recursos limitados"],
                status: "open",
                replies: 35,
                views: 128,
                lastUpdate: "Hace 4 horas",
                isHighlighted: true
            },
            {
                id: 5,
                title: "Experiencias con MALLO para análisis de jurisprudencia",
                content: "Resultados y casos de uso del sistema MultiAgent para identificar patrones en jurisprudencia.",
                author: {
                    name: "Juan Pérez",
                    avatar: "JP",
                    role: "Analista Judicial"
                },
                category: "soluciones",
                tags: ["MALLO", "jurisprudencia", "análisis"],
                status: "open",
                replies: 27,
                views: 112,
                lastUpdate: "Hace 1 día"
            },

            // Categoría: Mejores Prácticas
            {
                id: 7,
                title: "Implementación",
                content: "Estrategias para implementar soluciones efectivamente en entornos judiciales.",
                author: {
                    name: "Ana Gómez",
                    avatar: "AG",
                    role: "Directora de Proyectos"
                },
                category: "practicas",
                tags: ["implementación", "estrategias", "proyectos"],
                status: "open",
                replies: 876,
                views: 2340,
                lastUpdate: "Hace 3 horas",
                topics: 120
            },
            {
                id: 8,
                title: "Capacitación",
                content: "Recursos y métodos para capacitar usuarios en las herramientas del ecosistema Marduk.",
                author: {
                    name: "Roberto Vargas",
                    avatar: "RV",
                    role: "Coordinador de Capacitación"
                },
                category: "practicas",
                tags: ["capacitación", "formación", "recursos"],
                status: "open",
                replies: 654,
                views: 1780,
                lastUpdate: "Hace 5 horas",
                topics: 85
            },
            {
                id: 9,
                title: "Optimización",
                content: "Técnicas para maximizar el valor de las soluciones del ecosistema Marduk.",
                author: {
                    name: "Patricia Mendoza",
                    avatar: "PM",
                    role: "Especialista en Optimización"
                },
                category: "practicas",
                tags: ["optimización", "eficiencia", "mejora continua"],
                status: "open",
                replies: 626,
                views: 1950,
                lastUpdate: "Hace 2 horas",
                topics: 137
            },

            // Categoría: Colaboración
            {
                id: 10,
                title: "Incubadora de ideas",
                content: "Propuestas para nuevas soluciones y funcionalidades en el ecosistema Marduk.",
                author: {
                    name: "Fernando Torres",
                    avatar: "FT",
                    role: "Coordinador de Innovación"
                },
                category: "colaboracion",
                tags: ["ideas", "innovación", "propuestas"],
                status: "open",
                replies: 542,
                views: 1450,
                lastUpdate: "Hace 4 horas",
                topics: 87
            },
            {
                id: 11,
                title: "Proyectos activos",
                content: "Iniciativas en desarrollo que buscan colaboradores en el ecosistema Marduk.",
                author: {
                    name: "Diana Herrera",
                    avatar: "DH",
                    role: "Gerente de Proyectos"
                },
                category: "colaboracion",
                tags: ["proyectos", "colaboración", "desarrollo"],
                status: "open",
                replies: 387,
                views: 980,
                lastUpdate: "Hace 6 horas",
                topics: 45
            },
            {
                id: 12,
                title: "Desarrollo de código",
                content: "Discusiones técnicas sobre implementación y desarrollo en el ecosistema Marduk.",
                author: {
                    name: "Miguel Ángel Ruiz",
                    avatar: "MR",
                    role: "Desarrollador Senior"
                },
                category: "colaboracion",
                tags: ["código", "desarrollo", "técnico"],
                status: "open",
                replies: 314,
                views: 870,
                lastUpdate: "Hace 8 horas",
                topics: 46
            },

            // Categoría: Técnico
            {
                id: 6,
                title: "Integración de SGEJ con sistemas de terceros",
                content: "Opciones y mejores prácticas para integrar el Sistema de Gestión con otras plataformas.",
                author: {
                    name: "Carlos López",
                    avatar: "CL",
                    role: "Desarrollador Senior"
                },
                category: "tecnico",
                tags: ["SGEJ", "integración", "API"],
                status: "solved",
                replies: 19,
                views: 87,
                lastUpdate: "Hace 3 días"
            },
            {
                id: 13,
                title: "Documentación de la API de SGEJ v2.5",
                content: "Recursos y ejemplos para trabajar con la nueva versión de la API del Sistema de Gestión de Expedientes.",
                author: {
                    name: "Javier Morales",
                    avatar: "JM",
                    role: "Desarrollador Backend"
                },
                category: "tecnico",
                tags: ["API", "documentación", "SGEJ"],
                status: "open",
                replies: 16,
                views: 83,
                lastUpdate: "Hace 8 horas"
            },
            {
                id: 14,
                title: "Optimización de consultas en OmniChat",
                content: "Técnicas para mejorar la precisión y velocidad de las consultas en el asistente virtual.",
                author: {
                    name: "Laura Méndez",
                    avatar: "LM",
                    role: "Ingeniera de IA"
                },
                category: "tecnico",
                tags: ["OmniChat", "optimización", "consultas"],
                status: "open",
                replies: 21,
                views: 94,
                lastUpdate: "Hace 1 día"
            }
        ];

        // Función para generar el HTML de una discusión
        function generateDiscussionHTML(discussion) {
            const statusBadge = getStatusBadge(discussion.status);
            const highlightClass = discussion.isHighlighted ? 'bg-light-subtle' : '';

            return `
                <a href="javascript:void(0)" class="list-group-item list-group-item-action p-3 ${highlightClass}" data-id="${discussion.id}" data-category="${discussion.category}" onclick="showDiscussionDetail(${discussion.id}, '${discussion.category}')">
                    <div class="d-flex">
                        <div class="avatar-circle-sm me-3">${discussion.author.avatar}</div>
                        <div class="flex-grow-1">
                            <div class="d-flex justify-content-between align-items-center">
                                <h3 class="h6 fw-medium mb-0">${discussion.title}</h3>
                                ${statusBadge}
                            </div>
                            <p class="text-secondary small mb-2">
                                ${discussion.content}
                            </p>
                            <div class="d-flex flex-wrap gap-1 mb-2">
                                ${discussion.tags.map(tag => `<span class="badge bg-light text-secondary">${tag}</span>`).join('')}
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center small text-muted">
                                    <span>Por <strong>${discussion.author.name}</strong></span>
                                    <span class="mx-2">•</span>
                                    <span><i class="fa-solid fa-reply me-1"></i> ${discussion.replies} respuestas</span>
                                    <span class="mx-2">•</span>
                                    <span><i class="fa-solid fa-eye me-1"></i> ${discussion.views} vistas</span>
                                </div>
                                <span class="text-muted small">${discussion.lastUpdate}</span>
                            </div>
                        </div>
                    </div>
                </a>
            `;
        }

        // Función para obtener el badge de estado
        function getStatusBadge(status) {
            switch(status) {
                case 'open':
                    return '<span class="badge bg-success">Activo</span>';
                case 'solved':
                    return '<span class="badge bg-primary">Resuelto</span>';
                case 'closed':
                    return '<span class="badge bg-secondary">Cerrado</span>';
                default:
                    return '';
            }
        }

        // Función para filtrar discusiones por categoría
        function filterDiscussions(category = 'all') {
            const discussionsList = document.getElementById('discussionsList');
            discussionsList.innerHTML = '';

            const filteredDiscussions = category === 'all'
                ? discussions
                : discussions.filter(d => d.category === category);

            if (filteredDiscussions.length === 0) {
                discussionsList.innerHTML = `
                    <div class="text-center p-5">
                        <div class="mb-3"><i class="fas fa-comments fa-3x text-muted"></i></div>
                        <h3 class="h5 mb-2">No hay discusiones en esta categoría</h3>
                        <p class="text-muted">Sé el primero en iniciar una conversación</p>
                        <button class="btn btn-primary mt-2">
                            <i class="fas fa-plus-circle me-2"></i>Iniciar discusión
                        </button>
                    </div>
                `;
                return;
            }

            filteredDiscussions.forEach(discussion => {
                discussionsList.innerHTML += generateDiscussionHTML(discussion);
            });
        }

        // Función para obtener parámetros de la URL
        function getUrlParams() {
            const params = {};
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);

            for (const [key, value] of urlParams.entries()) {
                params[key] = value;
            }

            return params;
        }

        // Función para mostrar el detalle de una discusión
        function showDiscussionDetail(id, category) {
            // Buscar la discusión por ID y categoría
            const discussion = discussions.find(d => d.id === id && d.category === category);

            if (!discussion) {
                console.error('Discusión no encontrada');
                return;
            }

            // Actualizar URL sin recargar la página
            const url = new URL(window.location.href);
            url.searchParams.set('category', category);
            url.searchParams.set('id', id);
            window.history.pushState({}, '', url);

            // Actualizar los elementos de la vista detallada
            document.getElementById('detailTitle').textContent = discussion.title;
            document.getElementById('detailStatus').textContent = getStatusText(discussion.status);
            document.getElementById('detailStatus').className = getStatusBadgeClass(discussion.status);
            document.getElementById('detailAuthorAvatar').textContent = discussion.author.avatar;
            document.getElementById('detailAuthorName').textContent = discussion.author.name;
            document.getElementById('detailAuthorRole').textContent = discussion.author.role;
            document.getElementById('detailViews').textContent = discussion.views;
            document.getElementById('detailLastUpdate').textContent = discussion.lastUpdate;
            document.getElementById('detailRepliesCount').textContent = discussion.replies;

            // Actualizar contenido
            document.getElementById('detailContentAvatar').textContent = discussion.author.avatar;
            document.getElementById('detailContentAuthor').textContent = discussion.author.name;
            document.getElementById('detailContentRole').textContent = discussion.author.role;
            document.getElementById('detailContentDate').textContent = discussion.lastUpdate;
            document.getElementById('detailContent').innerHTML = `<p>${discussion.content}</p>`;

            // Actualizar etiquetas
            const tagsContainer = document.getElementById('detailTags');
            tagsContainer.innerHTML = '';
            discussion.tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'badge bg-light text-secondary';
                tagElement.textContent = tag;
                tagsContainer.appendChild(tagElement);
            });

            // Ocultar la lista de discusiones y mostrar el detalle
            document.getElementById('mainContent').classList.add('d-none');
            document.getElementById('discussionDetail').classList.remove('d-none');
        }

        // Función para volver a la lista de discusiones
        function backToList() {
            // Actualizar URL sin recargar la página
            const url = new URL(window.location.href);
            const category = url.searchParams.get('category');
            url.searchParams.delete('id');
            window.history.pushState({}, '', url);

            // Ocultar el detalle y mostrar la lista de discusiones
            document.getElementById('discussionDetail').classList.add('d-none');
            document.getElementById('mainContent').classList.remove('d-none');
        }

        // Función para obtener el texto del estado
        function getStatusText(status) {
            switch(status) {
                case 'open':
                    return 'Activo';
                case 'solved':
                    return 'Resuelto';
                case 'closed':
                    return 'Cerrado';
                default:
                    return 'Activo';
            }
        }

        // Función para obtener la clase del badge de estado
        function getStatusBadgeClass(status) {
            switch(status) {
                case 'open':
                    return 'badge bg-success';
                case 'solved':
                    return 'badge bg-primary';
                case 'closed':
                    return 'badge bg-secondary';
                default:
                    return 'badge bg-success';
            }
        }

        // Inicializar la página
        document.addEventListener('DOMContentLoaded', function() {
            // Obtener parámetros de la URL
            const params = getUrlParams();
            const category = params.category || 'all';
            const discussionId = params.id ? parseInt(params.id) : null;

            // Activar el botón de categoría correspondiente
            const categoryButtons = document.querySelectorAll('#categoryFilters button');
            categoryButtons.forEach(button => {
                const buttonCategory = button.getAttribute('data-category');
                if (buttonCategory === category) {
                    button.classList.remove('btn-outline-secondary');
                    button.classList.add('btn-primary');
                } else if (buttonCategory !== 'all') {
                    button.classList.remove('btn-primary');
                    button.classList.add('btn-outline-secondary');
                } else if (category === 'all') {
                    // Si la categoría es 'all', activar el botón 'Todas'
                    if (buttonCategory === 'all') {
                        button.classList.remove('btn-outline-secondary');
                        button.classList.add('btn-primary');
                    }
                }

                // Agregar event listener
                button.addEventListener('click', function() {
                    // Actualizar estado activo de los botones
                    categoryButtons.forEach(btn => {
                        btn.classList.remove('btn-primary');
                        btn.classList.add('btn-outline-secondary');
                    });
                    this.classList.remove('btn-outline-secondary');
                    this.classList.add('btn-primary');

                    // Filtrar discusiones
                    const category = this.getAttribute('data-category');
                    filterDiscussions(category);

                    // Actualizar URL sin recargar la página
                    const url = new URL(window.location.href);
                    if (category === 'all') {
                        url.searchParams.delete('category');
                    } else {
                        url.searchParams.set('category', category);
                    }
                    url.searchParams.delete('id'); // Eliminar ID al cambiar de categoría
                    window.history.pushState({}, '', url);

                    // Asegurarse de que estamos en la vista de lista
                    document.getElementById('discussionDetail').classList.add('d-none');
                    document.getElementById('mainContent').classList.remove('d-none');
                });
            });

            // Configurar botón de volver
            document.getElementById('backToList').addEventListener('click', backToList);

            // Cargar discusiones según la categoría
            filterDiscussions(category);

            // Si hay un ID de discusión, mostrar el detalle
            if (discussionId) {
                const discussion = discussions.find(d => d.id === discussionId && d.category === category);
                if (discussion) {
                    showDiscussionDetail(discussionId, category);
                } else {
                    // Si no se encuentra la discusión, resaltar en la lista
                    setTimeout(() => {
                        const discussionElement = document.querySelector(`#discussionsList a[data-id="${discussionId}"]`);
                        if (discussionElement) {
                            discussionElement.classList.add('bg-light-subtle');
                            discussionElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100); // Pequeño retraso para asegurar que las discusiones estén cargadas
                }
            }

            // Configurar búsqueda
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const discussionItems = document.querySelectorAll('#discussionsList a');

                    discussionItems.forEach(item => {
                        const title = item.querySelector('h3').textContent.toLowerCase();
                        const content = item.querySelector('p').textContent.toLowerCase();

                        if (title.includes(searchTerm) || content.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            }
        });
    </script>
</body>
</html>
